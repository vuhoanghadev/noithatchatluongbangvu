<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thêm Sản phẩm - Nội Thất Chất Lượng Bàng Vũ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.quilljs.com/1.3.6/quill.snow.css">
    <link rel="stylesheet" href="css/admin.css">
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <img src="../images/logo.svg" alt="Logo" class="sidebar-logo">
                <h2>Admin Panel</h2>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="index.html"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                    <li><a href="products.html" class="active"><i class="fas fa-box"></i> Sản phẩm</a></li>
                    <li><a href="blog.html"><i class="fas fa-newspaper"></i> Bài viết</a></li>
                    <li><a href="media.html"><i class="fas fa-images"></i> Thư viện</a></li>
                    <li><a href="settings.html"><i class="fas fa-cog"></i> Cài đặt</a></li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <p>Đăng nhập với: Admin</p>
                <a href="#" class="logout-btn"><i class="fas fa-sign-out-alt"></i> Đăng xuất</a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="main-header">
                <div class="header-left">
                    <button id="toggle-sidebar" class="toggle-btn">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1>Thêm Sản phẩm mới</h1>
                </div>
                <div class="header-right">
                    <div class="autosave-status">
                        <span id="autosave-indicator"><i class="fas fa-save"></i> Tự động lưu</span>
                    </div>
                    <div class="user-profile">
                        <img src="../images/avatar-placeholder.png" alt="User">
                        <span>Admin</span>
                    </div>
                </div>
            </header>

            <!-- Product Form -->
            <div class="product-form-container">
                <div class="form-actions-top">
                    <button id="save-draft" class="btn btn-outline"><i class="fas fa-save"></i> Lưu nháp</button>
                    <button id="preview-product" class="btn btn-secondary"><i class="fas fa-eye"></i> Xem trước</button>
                    <button id="publish-product" class="btn btn-primary"><i class="fas fa-check"></i> Xuất bản</button>
                </div>

                <!-- Tabs -->
                <div class="form-tabs">
                    <button class="tab-btn active" data-tab="basic-info">Thông tin cơ bản</button>
                    <button class="tab-btn" data-tab="images">Hình ảnh & Thư viện</button>
                    <button class="tab-btn" data-tab="promotion">Khuyến mãi</button>
                    <button class="tab-btn" data-tab="flash-sale">Flash Sale</button>
                    <button class="tab-btn" data-tab="specifications">Thông số kỹ thuật</button>
                    <button class="tab-btn" data-tab="detailed-desc">Mô tả chi tiết</button>
                    <button class="tab-btn" data-tab="reviews">Đánh giá & Bình luận</button>
                    <button class="tab-btn" data-tab="policies">Chính sách & Bảo quản</button>
                </div>

                <form id="product-form">
                    <!-- Basic Info Tab -->
                    <div class="tab-content active" id="basic-info-tab">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="product-id">ID sản phẩm</label>
                                <input type="number" id="product-id" name="id" readonly placeholder="Tự động tạo">
                            </div>
                            <div class="form-group">
                                <label for="product-name">Tên sản phẩm <span class="required">*</span></label>
                                <input type="text" id="product-name" name="name" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="product-category">Danh mục <span class="required">*</span></label>
                                <div class="category-select-container">
                                    <select id="product-category" name="category" required>
                                        <option value="">Chọn danh mục</option>
                                        <option value="Tủ Quần Áo">Tủ Quần Áo</option>
                                        <option value="Tủ Bếp">Tủ Bếp</option>
                                        <option value="Bàn Học">Bàn Học</option>
                                        <option value="Bàn Làm Việc">Bàn Làm Việc</option>
                                        <option value="Bàn Trang Điểm">Bàn Trang Điểm</option>
                                        <option value="Tủ Giày">Tủ Giày</option>
                                        <option value="Tủ Sách">Tủ Sách</option>
                                        <option value="Giường Ngủ">Giường Ngủ</option>
                                    </select>
                                    <button type="button" id="add-category" class="btn btn-sm"><i class="fas fa-plus"></i></button>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="product-tag">Tag</label>
                                <input type="text" id="product-tag" name="tag" placeholder="Ví dụ: Mới, Bán chạy, ...">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="product-description">Mô tả ngắn</label>
                            <textarea id="product-description" name="description" rows="4"></textarea>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="product-size">Kích thước</label>
                                <input type="text" id="product-size" name="size" placeholder="Ví dụ: 120x180x50cm">
                            </div>
                            <div class="form-group">
                                <label for="product-material">Chất liệu</label>
                                <input type="text" id="product-material" name="material" placeholder="Ví dụ: Gỗ MDF phủ melamine">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="product-warranty">Bảo hành</label>
                                <input type="text" id="product-warranty" name="warranty" placeholder="Ví dụ: 10 năm">
                            </div>
                            <div class="form-group price-group">
                                <label>Giá</label>
                                <div class="price-inputs">
                                    <div class="price-option">
                                        <input type="radio" id="price-contact" name="price-type" value="contact" checked>
                                        <label for="price-contact">Liên hệ</label>
                                    </div>
                                    <div class="price-option">
                                        <input type="radio" id="price-value" name="price-type" value="value">
                                        <label for="price-value">Nhập giá</label>
                                        <input type="text" id="product-price" name="price" placeholder="Ví dụ: 5.000.000" disabled>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="product-sku">SKU</label>
                                <div class="sku-inputs">
                                    <input type="text" id="product-sku" name="sku" placeholder="Ví dụ: NTBV-QA205">
                                    <div class="auto-sku">
                                        <input type="checkbox" id="auto-generate-sku">
                                        <label for="auto-generate-sku">Tự động tạo từ tên</label>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="product-featured">Sản phẩm nổi bật</label>
                                <div class="featured-toggle">
                                    <input type="checkbox" id="product-featured" name="featured">
                                    <label for="product-featured" class="toggle-label"></label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Images Tab -->
                    <div class="tab-content" id="images-tab">
                        <div class="form-group">
                            <label>Hình ảnh chính <span class="required">*</span></label>
                            <div class="main-image-upload">
                                <div class="image-preview" id="main-image-preview">
                                    <i class="fas fa-image"></i>
                                    <span>Chưa có hình ảnh</span>
                                </div>
                                <div class="upload-controls">
                                    <input type="file" id="main-image-input" accept="image/*" style="display: none;">
                                    <button type="button" id="upload-main-image" class="btn btn-primary"><i class="fas fa-upload"></i> Tải lên</button>
                                    <button type="button" id="remove-main-image" class="btn btn-danger" style="display: none;"><i class="fas fa-trash"></i> Xóa</button>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Thư viện hình ảnh</label>
                            <div class="gallery-upload">
                                <div class="gallery-preview" id="gallery-preview">
                                    <div class="upload-placeholder">
                                        <i class="fas fa-plus"></i>
                                        <span>Thêm hình ảnh</span>
                                    </div>
                                </div>
                                <div class="upload-controls">
                                    <input type="file" id="gallery-image-input" accept="image/*" multiple style="display: none;">
                                    <button type="button" id="upload-gallery-images" class="btn btn-primary"><i class="fas fa-upload"></i> Tải lên nhiều</button>
                                    <p class="help-text">Kéo thả để sắp xếp thứ tự hình ảnh</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Promotion Tab -->
                    <div class="tab-content" id="promotion-tab">
                        <div class="form-group">
                            <label for="has-promotion">Có khuyến mãi</label>
                            <div class="promotion-toggle">
                                <input type="checkbox" id="has-promotion" name="has-promotion">
                                <label for="has-promotion" class="toggle-label"></label>
                            </div>
                        </div>

                        <div id="promotion-details" style="display: none;">
                            <div class="form-group">
                                <label for="promotion-text">Nội dung khuyến mãi <span class="required">*</span></label>
                                <input type="text" id="promotion-text" name="promotion" placeholder="Ví dụ: Giảm 10%, Ưu đãi đặc biệt, ...">
                            </div>

                            <div class="form-group">
                                <label for="promotion-end-date">Ngày kết thúc khuyến mãi <span class="required">*</span></label>
                                <input type="text" id="promotion-end-date" name="promoEndDate" class="date-picker" placeholder="Chọn ngày và giờ">
                            </div>

                            <div class="form-group">
                                <label for="show-countdown">Hiển thị đồng hồ đếm ngược</label>
                                <div class="countdown-toggle">
                                    <input type="checkbox" id="show-countdown" name="show-countdown" checked>
                                    <label for="show-countdown" class="toggle-label"></label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Flash Sale Tab -->
                    <div class="tab-content" id="flash-sale-tab">
                        <div class="form-group">
                            <label for="has-flashsale">Kích hoạt Flash Sale</label>
                            <div class="flashsale-toggle">
                                <input type="checkbox" id="has-flashsale" name="has-flashsale">
                                <label for="has-flashsale" class="toggle-label"></label>
                            </div>
                        </div>

                        <div id="flashsale-details" style="display: none;">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="flashsale-discount">Phần trăm giảm giá (%)</label>
                                    <input type="number" id="flashsale-discount" name="discountPercent" min="1" max="100" placeholder="Ví dụ: 20">
                                </div>
                                <div class="form-group">
                                    <label for="flashsale-type">Loại Flash Sale</label>
                                    <select id="flashsale-type" name="flashsale-type">
                                        <option value="fixed">Cố định (đến ngày cụ thể)</option>
                                        <option value="daily">Hàng ngày (đến giờ cụ thể mỗi ngày)</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="flashsale-old-price">Giá gốc</label>
                                    <input type="number" id="flashsale-old-price" name="oldPrice" placeholder="Ví dụ: 5000000">
                                </div>
                                <div class="form-group">
                                    <label for="flashsale-new-price">Giá đã giảm</label>
                                    <input type="number" id="flashsale-new-price" name="newPrice" placeholder="Tự động tính">
                                </div>
                            </div>

                            <div id="fixed-flashsale-fields">
                                <div class="form-group">
                                    <label for="flashsale-end-date">Thời gian kết thúc</label>
                                    <input type="text" id="flashsale-end-date" name="endsAt" class="date-picker" placeholder="Chọn ngày và giờ">
                                </div>
                            </div>

                            <div id="daily-flashsale-fields" style="display: none;">
                                <div class="form-group">
                                    <label for="flashsale-end-time">Giờ kết thúc hàng ngày</label>
                                    <input type="time" id="flashsale-end-time" name="dailyEndTime" value="23:59">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="hide-price">Ẩn giá</label>
                                <div class="hide-price-toggle">
                                    <input type="checkbox" id="hide-price" name="hidePrice">
                                    <label for="hide-price" class="toggle-label"></label>
                                </div>
                                <p class="help-text">Khi bật, giá sẽ không hiển thị trên trang sản phẩm</p>
                            </div>
                        </div>
                    </div>

                    <!-- Specifications Tab -->
                    <div class="tab-content" id="specifications-tab">
                        <div class="form-group">
                            <label>Thông số kỹ thuật</label>
                            <div class="specifications-container">
                                <table class="specifications-table">
                                    <thead>
                                        <tr>
                                            <th>Tên thông số</th>
                                            <th>Giá trị</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody id="specifications-list">
                                        <tr>
                                            <td><input type="text" name="spec-name[]" placeholder="Ví dụ: Kích thước"></td>
                                            <td><input type="text" name="spec-value[]" placeholder="Ví dụ: 120x180x50cm"></td>
                                            <td><button type="button" class="btn-remove-row"><i class="fas fa-trash"></i></button></td>
                                        </tr>
                                    </tbody>
                                </table>
                                <button type="button" id="add-specification" class="btn btn-outline"><i class="fas fa-plus"></i> Thêm thông số</button>
                            </div>
                        </div>
                    </div>

                    <!-- Detailed Description Tab -->
                    <div class="tab-content" id="detailed-desc-tab">
                        <div class="form-group">
                            <label for="detailed-description">Mô tả chi tiết</label>
                            <div id="detailed-description-editor"></div>
                            <input type="hidden" id="detailed-description-content" name="detailedDescription">
                        </div>

                        <div class="form-group">
                            <label>Hình ảnh mô tả</label>
                            <div class="description-images">
                                <div class="description-images-list" id="description-images-list">
                                    <!-- Description images will be added here -->
                                </div>
                                <div class="upload-controls">
                                    <input type="file" id="description-image-input" accept="image/*" style="display: none;">
                                    <button type="button" id="add-description-image" class="btn btn-outline"><i class="fas fa-plus"></i> Thêm hình ảnh</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Reviews Tab -->
                    <div class="tab-content" id="reviews-tab">
                        <div class="form-group">
                            <label>Đánh giá sản phẩm</label>
                            <div class="reviews-container">
                                <div class="reviews-list" id="reviews-list">
                                    <p class="empty-reviews">Chưa có đánh giá nào.</p>
                                </div>
                                <button type="button" id="add-review" class="btn btn-outline"><i class="fas fa-plus"></i> Thêm đánh giá</button>
                            </div>
                        </div>
                    </div>

                    <!-- Policies Tab -->
                    <div class="tab-content" id="policies-tab">
                        <div class="form-group">
                            <label for="shipping-policy">Chính sách vận chuyển</label>
                            <textarea id="shipping-policy" name="shipping" rows="3" placeholder="Nhập chính sách vận chuyển..."></textarea>
                        </div>

                        <div class="form-group">
                            <label for="returns-policy">Chính sách đổi trả</label>
                            <textarea id="returns-policy" name="returns" rows="3" placeholder="Nhập chính sách đổi trả..."></textarea>
                        </div>

                        <div class="form-group">
                            <label for="warranty-policy">Chính sách bảo hành</label>
                            <textarea id="warranty-policy" name="warranty-policy" rows="3" placeholder="Nhập chính sách bảo hành..."></textarea>
                        </div>

                        <div class="form-group">
                            <label for="payment-policy">Chính sách thanh toán</label>
                            <textarea id="payment-policy" name="payment" rows="3" placeholder="Nhập chính sách thanh toán..."></textarea>
                        </div>

                        <div class="form-group">
                            <label for="care-instructions">Hướng dẫn bảo quản</label>
                            <textarea id="care-instructions" name="care-instructions" rows="3" placeholder="Nhập hướng dẫn bảo quản..."></textarea>
                        </div>

                        <div class="form-group">
                            <label>Mẹo bảo quản</label>
                            <div class="care-tips-container">
                                <ul id="care-tips-list">
                                    <li>
                                        <input type="text" name="care-tip[]" placeholder="Nhập mẹo bảo quản...">
                                        <button type="button" class="btn-remove-tip"><i class="fas fa-trash"></i></button>
                                    </li>
                                </ul>
                                <button type="button" id="add-care-tip" class="btn btn-outline"><i class="fas fa-plus"></i> Thêm mẹo</button>
                            </div>
                        </div>
                    </div>
                </form>

                <div class="form-actions-bottom">
                    <button id="save-draft-bottom" class="btn btn-outline"><i class="fas fa-save"></i> Lưu nháp</button>
                    <button id="preview-product-bottom" class="btn btn-secondary"><i class="fas fa-eye"></i> Xem trước</button>
                    <button id="publish-product-bottom" class="btn btn-primary"><i class="fas fa-check"></i> Xuất bản</button>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <div class="modal" id="add-category-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Thêm danh mục mới</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="new-category-name">Tên danh mục</label>
                    <input type="text" id="new-category-name" placeholder="Nhập tên danh mục mới">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-add-category">Hủy</button>
                <button class="btn btn-primary" id="confirm-add-category">Thêm</button>
            </div>
        </div>
    </div>

    <div class="modal" id="add-review-modal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2>Thêm đánh giá</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label for="review-author">Tên người đánh giá</label>
                        <input type="text" id="review-author" placeholder="Nhập tên người đánh giá">
                    </div>
                    <div class="form-group">
                        <label for="review-date">Ngày đánh giá</label>
                        <input type="text" id="review-date" class="date-picker" placeholder="Chọn ngày">
                    </div>
                </div>
                <div class="form-group">
                    <label for="review-rating">Đánh giá (số sao)</label>
                    <div class="rating-input">
                        <i class="far fa-star" data-rating="1"></i>
                        <i class="far fa-star" data-rating="2"></i>
                        <i class="far fa-star" data-rating="3"></i>
                        <i class="far fa-star" data-rating="4"></i>
                        <i class="far fa-star" data-rating="5"></i>
                        <input type="hidden" id="review-rating" value="0">
                    </div>
                </div>
                <div class="form-group">
                    <label for="review-content">Nội dung đánh giá</label>
                    <textarea id="review-content" rows="4" placeholder="Nhập nội dung đánh giá"></textarea>
                </div>
                <div class="form-group">
                    <label>Hình ảnh đính kèm</label>
                    <div class="review-images-container">
                        <div class="review-images-list" id="review-images-list">
                            <!-- Review images will be added here -->
                        </div>
                        <div class="upload-controls">
                            <input type="file" id="review-image-input" accept="image/*" multiple style="display: none;">
                            <button type="button" id="add-review-image" class="btn btn-outline"><i class="fas fa-plus"></i> Thêm hình ảnh</button>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="review-anonymous">Ẩn danh</label>
                    <div class="anonymous-toggle">
                        <input type="checkbox" id="review-anonymous">
                        <label for="review-anonymous" class="toggle-label"></label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancel-add-review">Hủy</button>
                <button class="btn btn-primary" id="confirm-add-review">Thêm</button>
            </div>
        </div>
    </div>

    <div class="modal" id="unsaved-changes-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Thay đổi chưa lưu</h2>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Bạn có thay đổi chưa lưu. Bạn có muốn lưu trước khi rời đi không?</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="discard-changes">Hủy thay đổi</button>
                <button class="btn btn-secondary" id="save-and-leave">Lưu và rời đi</button>
                <button class="btn btn-primary" id="stay">Ở lại</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <script src="js/admin.js"></script>
    <script src="js/product-form.js"></script>
</body>
</html>
